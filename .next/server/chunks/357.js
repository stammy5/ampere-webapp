"use strict";exports.id=357,exports.ids=[357],exports.modules={6697:(e,t,a)=>{a.d(t,{Z:()=>r});let r=(0,a(2881).Z)("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},7636:(e,t,a)=>{a.d(t,{Z:()=>r});let r=(0,a(2881).Z)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},3498:(e,t,a)=>{a.d(t,{Z:()=>h});var r=a(326),s=a(7577),l=a(1223),n=a(9682),o=a(4471),d=a(8932),i=a(4019),c=a(7636),m=a(1821),u=a(7358),p=a(1215);let x=[{value:"renovation",label:"Renovation"},{value:"addition_alteration",label:"Addition & Alteration"},{value:"reinstatement",label:"Reinstatement"},{value:"new_construction",label:"New Construction"},{value:"maintenance",label:"Maintenance"}],g=[{value:"planning",label:"Planning"},{value:"permit_application",label:"Permit Application"},{value:"approved",label:"Approved"},{value:"in_progress",label:"In Progress"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"},{value:"on_hold",label:"On Hold"}],b=e=>{if(!e)return"";let t=parseInt(e.substring(0,2));return t>=1&&t<=6?"Downtown Core":t>=7&&t<=8?"Marina East":t>=9&&t<=10?"Museum":t>=11&&t<=13?"Newton":t>=14&&t<=16?"Orchard":t>=17&&t<=19?"Outram":t>=20&&t<=21?"River Valley":t>=28&&t<=30?"Novena":t>=31&&t<=33?"Toa Payoh":t>=34&&t<=36?"Bishan":t>=37&&t<=39?"Ang Mo Kio":t>=40&&t<=41?"Hougang":t>=46&&t<=48?"Serangoon":t>=49&&t<=50?"Tampines":t>=51&&t<=52?"Pasir Ris":t>=53&&t<=54?"Bedok":t>=55&&t<=57?"Clementi":t>=58&&t<=59?"Jurong East":t>=60&&t<=64?"Jurong West":t>=68&&t<=69?"Bukit Merah":t>=75&&t<=77?"Sembawang":t>=78&&t<=79?"Yishun":t>=80&&t<=82?"Woodlands":"Central"};function h({project:e,isOpen:t,onClose:a,onSave:h,mode:j,isLoading:f=!1}){let{clients:v}=(0,n.a)(),{user:y}=(0,o.a)(),[N,C]=(0,s.useState)({name:e?.name||"",clientId:e?.clientId||"",type:e?.type||"renovation",status:e?.status||"planning",description:e?.description||"",location:{street:e?.location?.street||"",building:e?.location?.building||"",unit:e?.location?.unit||"",postalCode:e?.location?.postalCode||"",district:e?.location?.district||""},contractValue:e?.contractValue||0,estimatedCost:e?.estimatedCost||0,actualCost:e?.actualCost||0,startDate:e?.startDate?new Date(e.startDate).toISOString().split("T")[0]:"",expectedEndDate:e?.expectedEndDate?new Date(e.expectedEndDate).toISOString().split("T")[0]:"",actualEndDate:e?.actualEndDate?new Date(e.actualEndDate).toISOString().split("T")[0]:"",projectManager:e?.projectManager||y?.id||"",team:e?.team||[]}),[D,w]=(0,s.useState)({}),E=(e,t)=>{if(e.startsWith("location.")){let a=e.split(".")[1];C(e=>({...e,location:{...e.location,[a]:t}}))}else C(a=>({...a,[e]:t}));D[e]&&w(t=>({...t,[e]:""}))},k=()=>{let e={};if(N.name.trim()||(e.name="Project name is required"),N.clientId||(e.clientId="Client selection is required"),N.description.trim()||(e.description="Description is required"),N.location.street.trim()||(e["location.street"]="Street address is required"),N.location.postalCode.trim()||(e["location.postalCode"]="Postal code is required"),N.contractValue<=0&&(e.contractValue="Contract value must be greater than 0"),N.estimatedCost<=0&&(e.estimatedCost="Estimated cost must be greater than 0"),N.startDate||(e.startDate="Start date is required"),N.expectedEndDate||(e.expectedEndDate="Expected end date is required"),N.projectManager||(e.projectManager="Project manager is required"),N.location.postalCode&&!/^\d{6}$/.test(N.location.postalCode)&&(e["location.postalCode"]="Postal code must be 6 digits"),N.startDate&&N.expectedEndDate){let t=new Date(N.startDate);new Date(N.expectedEndDate)<=t&&(e.expectedEndDate="Expected end date must be after start date")}return w(e),0===Object.keys(e).length},S=async e=>{if(e.preventDefault(),!k())return;let t={name:N.name.trim(),clientId:N.clientId,type:N.type,status:N.status,description:N.description.trim(),location:{street:N.location.street.trim(),building:N.location.building?.trim()||void 0,unit:N.location.unit?.trim()||void 0,postalCode:N.location.postalCode.trim(),district:N.location.district||b(N.location.postalCode)},contractValue:N.contractValue,estimatedCost:N.estimatedCost,actualCost:N.actualCost||void 0,startDate:new Date(N.startDate),expectedEndDate:new Date(N.expectedEndDate),actualEndDate:N.actualEndDate?new Date(N.actualEndDate):void 0,projectManager:N.projectManager,team:N.team};await h(t)},M=e=>new Intl.NumberFormat("en-SG",{style:"currency",currency:"SGD"}).format(e);return t?r.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[r.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:r.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75",onClick:a})}),(0,r.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:[r.jsx("div",{className:"bg-white px-6 py-4 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"w-10 h-10 bg-ampere-100 rounded-lg flex items-center justify-center",children:r.jsx(d.Z,{className:"h-5 w-5 text-ampere-600"})}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"add"===j?"Create New Project":"Edit Project"}),r.jsx("p",{className:"text-sm text-gray-600",children:"add"===j?"Set up a new construction project":"Update project details and specifications"})]})]}),r.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 p-2 rounded-lg hover:bg-gray-100",children:r.jsx(i.Z,{className:"h-5 w-5"})})]})}),(0,r.jsxs)("form",{onSubmit:S,className:"p-6",children:[(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Project Information"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project Name *"}),r.jsx("input",{type:"text",value:N.name,onChange:e=>E("name",e.target.value),className:(0,l.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",D.name?"border-red-300":"border-gray-300"),placeholder:"Enter project name"}),D.name&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:D.name})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client *"}),(0,r.jsxs)("select",{value:N.clientId,onChange:e=>E("clientId",e.target.value),className:(0,l.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",D.clientId?"border-red-300":"border-gray-300"),children:[r.jsx("option",{value:"",children:"Select Client"}),v.filter(e=>"active"===e.status).map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))]}),D.clientId&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:D.clientId})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project Type"}),r.jsx("select",{value:N.type,onChange:e=>E("type",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",children:x.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),r.jsx("select",{value:N.status,onChange:e=>E("status",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",children:g.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project Manager *"}),(0,r.jsxs)("select",{value:N.projectManager,onChange:e=>E("projectManager",e.target.value),className:(0,l.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",D.projectManager?"border-red-300":"border-gray-300"),children:[r.jsx("option",{value:"",children:"Select Project Manager"}),r.jsx("option",{value:"1",children:"John Tan"}),r.jsx("option",{value:"2",children:"Sarah Lim"}),r.jsx("option",{value:"3",children:"David Wong"}),r.jsx("option",{value:"4",children:"Michelle Chen"}),r.jsx("option",{value:"5",children:"Robert Kumar"})]}),D.projectManager&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:D.projectManager})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),r.jsx("textarea",{value:N.description,onChange:e=>E("description",e.target.value),rows:3,className:(0,l.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",D.description?"border-red-300":"border-gray-300"),placeholder:"Describe the project scope and requirements..."}),D.description&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:D.description})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"text-md font-semibold text-gray-900 mb-4 flex items-center",children:[r.jsx(c.Z,{className:"h-4 w-4 mr-2 text-ampere-600"}),"Project Location"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Street Address *"}),r.jsx("input",{type:"text",value:N.location.street,onChange:e=>E("location.street",e.target.value),className:(0,l.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",D["location.street"]?"border-red-300":"border-gray-300"),placeholder:"Enter street address"}),D["location.street"]&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:D["location.street"]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Building Name"}),r.jsx("input",{type:"text",value:N.location.building,onChange:e=>E("location.building",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",placeholder:"Building or development name"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit Number"}),r.jsx("input",{type:"text",value:N.location.unit,onChange:e=>E("location.unit",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",placeholder:"Unit or floor number"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Postal Code *"}),r.jsx("input",{type:"text",value:N.location.postalCode,onChange:e=>E("location.postalCode",e.target.value),className:(0,l.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",D["location.postalCode"]?"border-red-300":"border-gray-300"),placeholder:"6-digit postal code",maxLength:6}),D["location.postalCode"]&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:D["location.postalCode"]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"District"}),r.jsx("input",{type:"text",value:N.location.district,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",placeholder:"Auto-filled based on postal code",readOnly:!0})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"text-md font-semibold text-gray-900 mb-4 flex items-center",children:[r.jsx(m.Z,{className:"h-4 w-4 mr-2 text-ampere-600"}),"Financial Details"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contract Value (SGD) *"}),r.jsx("input",{type:"number",value:N.contractValue,onChange:e=>E("contractValue",parseFloat(e.target.value)||0),className:(0,l.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",D.contractValue?"border-red-300":"border-gray-300"),min:"0",step:"0.01"}),D.contractValue&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:D.contractValue})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estimated Cost (SGD) *"}),r.jsx("input",{type:"number",value:N.estimatedCost,onChange:e=>E("estimatedCost",parseFloat(e.target.value)||0),className:(0,l.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",D.estimatedCost?"border-red-300":"border-gray-300"),min:"0",step:"0.01"}),D.estimatedCost&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:D.estimatedCost})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Actual Cost (SGD)"}),r.jsx("input",{type:"number",value:N.actualCost,onChange:e=>E("actualCost",parseFloat(e.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",min:"0",step:"0.01"})]})]}),N.contractValue>0&&N.estimatedCost>0&&r.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,r.jsxs)("div",{children:[r.jsx("span",{className:"text-gray-600",children:"Estimated Margin:"}),(0,r.jsxs)("p",{className:(0,l.cn)("font-medium",N.contractValue-N.estimatedCost>0?"text-green-600":"text-red-600"),children:[M(N.contractValue-N.estimatedCost),"(",Math.round((N.contractValue-N.estimatedCost)/N.contractValue*100),"%)"]})]}),N.actualCost>0&&(0,r.jsxs)("div",{children:[r.jsx("span",{className:"text-gray-600",children:"Actual Margin:"}),(0,r.jsxs)("p",{className:(0,l.cn)("font-medium",N.contractValue-N.actualCost>0?"text-green-600":"text-red-600"),children:[M(N.contractValue-N.actualCost),"(",Math.round((N.contractValue-N.actualCost)/N.contractValue*100),"%)"]})]})]})})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"text-md font-semibold text-gray-900 mb-4 flex items-center",children:[r.jsx(u.Z,{className:"h-4 w-4 mr-2 text-ampere-600"}),"Project Timeline"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date *"}),r.jsx("input",{type:"date",value:N.startDate,onChange:e=>E("startDate",e.target.value),className:(0,l.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",D.startDate?"border-red-300":"border-gray-300")}),D.startDate&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:D.startDate})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expected End Date *"}),r.jsx("input",{type:"date",value:N.expectedEndDate,onChange:e=>E("expectedEndDate",e.target.value),className:(0,l.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",D.expectedEndDate?"border-red-300":"border-gray-300")}),D.expectedEndDate&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:D.expectedEndDate})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Actual End Date"}),r.jsx("input",{type:"date",value:N.actualEndDate,onChange:e=>E("actualEndDate",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500"})]})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-end space-x-3 pt-6 mt-6 border-t border-gray-200",children:[r.jsx("button",{type:"button",onClick:a,disabled:f,className:"btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:f,className:"btn-primary flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:f?(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),r.jsx("span",{children:"add"===j?"Creating...":"Saving..."})]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(p.Z,{className:"h-4 w-4"}),r.jsx("span",{children:"add"===j?"Create Project":"Save Changes"})]})})]})]})]})]})}):null}}};