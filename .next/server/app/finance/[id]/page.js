(()=>{var e={};e.id=659,e.ids=[659],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7570:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>o,routeModule:()=>u,tree:()=>c}),a(1886),a(5967),a(5866);var s=a(3191),r=a(8716),n=a(7922),i=a.n(n),l=a(5231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);a.d(t,d);let c=["",{children:["finance",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,1886)),"C:\\Users\\stamm\\AMPERE WEBAPP\\src\\app\\finance\\[id]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,5967)),"C:\\Users\\stamm\\AMPERE WEBAPP\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,5866,23)),"next/dist/client/components/not-found-error"]}],o=["C:\\Users\\stamm\\AMPERE WEBAPP\\src\\app\\finance\\[id]\\page.tsx"],m="/finance/[id]/page",x={require:a,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/finance/[id]/page",pathname:"/finance/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},4327:(e,t,a)=>{Promise.resolve().then(a.bind(a,256))},6333:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8787:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]])},2257:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]])},7358:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},1291:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},361:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},8998:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},8916:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},1540:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},5932:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},2887:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},3855:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},1215:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},9508:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},949:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},256:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>F});var s=a(326),r=a(7577),n=a(5047),i=a(434),l=a(4471),d=a(9209),c=a(9682),o=a(1293),m=a(9884),x=a(1223),u=a(5956),h=a(6283),p=a(4019),g=a(2257),y=a(7358),j=a(1821),v=a(1215);let b=[{value:"draft",label:"Draft"},{value:"sent",label:"Sent"},{value:"overdue",label:"Overdue"},{value:"paid",label:"Paid"},{value:"cancelled",label:"Cancelled"}];function f({invoice:e,isOpen:t,onClose:a,onSave:n,mode:i,isLoading:d=!1}){let{clients:m}=(0,c.a)(),{projects:f}=(0,o.Z)(),{quotations:N}=(0,u._)(),{user:w}=(0,l.a)(),[D,k]=(0,r.useState)({clientId:e?.clientId||"",projectId:e?.projectId||"",quotationId:e?.quotationId||"",amount:e?.amount||0,gstAmount:e?.gstAmount||0,totalAmount:e?.totalAmount||0,status:e?.status||"draft",issueDate:e?.issueDate?new Date(e.issueDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],dueDate:e?.dueDate?new Date(e.dueDate).toISOString().split("T")[0]:"",paidDate:e?.paidDate?new Date(e.paidDate).toISOString().split("T")[0]:"",paymentMethod:e?.paymentMethod||""}),[C,P]=(0,r.useState)({}),I=(e,t)=>{k(a=>({...a,[e]:t})),C[e]&&P(t=>({...t,[e]:""}))},M=()=>{let e={};if(D.clientId||(e.clientId="Client selection is required"),D.amount<=0&&(e.amount="Amount must be greater than 0"),D.issueDate||(e.issueDate="Issue date is required"),D.dueDate||(e.dueDate="Due date is required"),D.issueDate&&D.dueDate){let t=new Date(D.issueDate);new Date(D.dueDate)<=t&&(e.dueDate="Due date must be after issue date")}if(D.paidDate&&D.issueDate){let t=new Date(D.issueDate);new Date(D.paidDate)<t&&(e.paidDate="Paid date cannot be before issue date")}return"paid"!==D.status||D.paymentMethod||(e.paymentMethod="Payment method is required for paid invoices"),P(e),0===Object.keys(e).length},Z=async e=>{if(e.preventDefault(),!M())return;let t={clientId:D.clientId,projectId:D.projectId||void 0,quotationId:D.quotationId||void 0,amount:D.amount,gstAmount:D.gstAmount,totalAmount:D.totalAmount,status:D.status,issueDate:new Date(D.issueDate),dueDate:new Date(D.dueDate),paidDate:D.paidDate?new Date(D.paidDate):void 0,paymentMethod:D.paymentMethod||void 0};await n(t)},A=e=>new Intl.NumberFormat("en-SG",{style:"currency",currency:"SGD"}).format(e),S=f.filter(e=>e.clientId===D.clientId),q=N.filter(e=>e.clientId===D.clientId);return t?s.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,s.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[s.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:s.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75",onClick:a})}),(0,s.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:[s.jsx("div",{className:"bg-white px-6 py-4 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-ampere-100 rounded-lg flex items-center justify-center",children:s.jsx(h.Z,{className:"h-5 w-5 text-ampere-600"})}),(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"add"===i?"Create New Invoice":"Edit Invoice"}),s.jsx("p",{className:"text-sm text-gray-600",children:"add"===i?"Generate an invoice for project work":"Update invoice details and payment information"})]})]}),s.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 p-2 rounded-lg hover:bg-gray-100",children:s.jsx(p.Z,{className:"h-5 w-5"})})]})}),(0,s.jsxs)("form",{onSubmit:Z,className:"p-6",children:[(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{children:[s.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Invoice Information"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client *"}),(0,s.jsxs)("select",{value:D.clientId,onChange:e=>I("clientId",e.target.value),className:(0,x.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",C.clientId?"border-red-300":"border-gray-300"),children:[s.jsx("option",{value:"",children:"Select Client"}),m.filter(e=>"active"===e.status).map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]}),C.clientId&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:C.clientId})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project"}),(0,s.jsxs)("select",{value:D.projectId,onChange:e=>I("projectId",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",disabled:!D.clientId,children:[s.jsx("option",{value:"",children:"No Project"}),S.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quotation"}),(0,s.jsxs)("select",{value:D.quotationId,onChange:e=>I("quotationId",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",disabled:!D.clientId,children:[s.jsx("option",{value:"",children:"No Quotation"}),q.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.quotationNumber," - ",e.title]},e.id))]})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),s.jsx("select",{value:D.status,onChange:e=>I("status",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",children:b.map(e=>s.jsx("option",{value:e.value,children:e.label},e.value))})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"text-md font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(g.Z,{className:"h-4 w-4 mr-2 text-ampere-600"}),"Financial Details"]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (SGD) *"}),s.jsx("input",{type:"number",value:D.amount,onChange:e=>I("amount",parseFloat(e.target.value)||0),className:(0,x.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",C.amount?"border-red-300":"border-gray-300"),min:"0",step:"0.01"}),C.amount&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:C.amount})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"GST (7%)"}),s.jsx("input",{type:"number",value:D.gstAmount,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",readOnly:!0})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Amount"}),s.jsx("input",{type:"number",value:D.totalAmount,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 font-medium",readOnly:!0})]})]}),D.totalAmount>0&&s.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),s.jsx("p",{className:"font-medium text-lg",children:A(D.amount)})]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-600",children:"GST (7%):"}),s.jsx("p",{className:"font-medium text-lg",children:A(D.gstAmount)})]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Total:"}),s.jsx("p",{className:"font-bold text-xl text-ampere-600",children:A(D.totalAmount)})]})]})})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"text-md font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(y.Z,{className:"h-4 w-4 mr-2 text-ampere-600"}),"Date Information"]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Issue Date *"}),s.jsx("input",{type:"date",value:D.issueDate,onChange:e=>I("issueDate",e.target.value),className:(0,x.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",C.issueDate?"border-red-300":"border-gray-300")}),C.issueDate&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:C.issueDate})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date *"}),s.jsx("input",{type:"date",value:D.dueDate,onChange:e=>I("dueDate",e.target.value),className:(0,x.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",C.dueDate?"border-red-300":"border-gray-300")}),C.dueDate&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:C.dueDate})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Paid Date"}),s.jsx("input",{type:"date",value:D.paidDate,onChange:e=>I("paidDate",e.target.value),className:(0,x.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",C.paidDate?"border-red-300":"border-gray-300")}),C.paidDate&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:C.paidDate})]})]})]}),("paid"===D.status||D.paidDate)&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"text-md font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(j.Z,{className:"h-4 w-4 mr-2 text-ampere-600"}),"Payment Information"]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),(0,s.jsxs)("select",{value:D.paymentMethod,onChange:e=>I("paymentMethod",e.target.value),className:(0,x.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",C.paymentMethod?"border-red-300":"border-gray-300"),children:[s.jsx("option",{value:"",children:"Select Payment Method"}),s.jsx("option",{value:"cash",children:"Cash"}),s.jsx("option",{value:"cheque",children:"Cheque"}),s.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),s.jsx("option",{value:"credit_card",children:"Credit Card"}),s.jsx("option",{value:"paynow",children:"PayNow"})]}),C.paymentMethod&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:C.paymentMethod})]})})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-end space-x-3 pt-6 mt-6 border-t border-gray-200",children:[s.jsx("button",{type:"button",onClick:a,disabled:d,className:"btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:d,className:"btn-primary flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:d?(0,s.jsxs)(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:"add"===i?"Creating...":"Saving..."})]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx(v.Z,{className:"h-4 w-4"}),s.jsx("span",{children:"add"===i?"Create Invoice":"Save Changes"})]})})]})]})]})]})}):null}var N=a(8916);let w=(0,a(2881).Z)("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);var D=a(1291);let k=[{value:"cash",label:"Cash",icon:"\uD83D\uDCB5"},{value:"cheque",label:"Cheque",icon:"\uD83D\uDCDD"},{value:"bank_transfer",label:"Bank Transfer",icon:"\uD83C\uDFE6"},{value:"credit_card",label:"Credit Card",icon:"\uD83D\uDCB3"},{value:"paynow",label:"PayNow",icon:"\uD83D\uDCF1"}];function C({payment:e,invoiceId:t,isOpen:a,onClose:n,onSave:i,mode:o,isLoading:m=!1}){let{invoices:u,getInvoice:h,getInvoicePayments:y}=(0,d.p)(),{clients:j}=(0,c.a)(),{user:b}=(0,l.a)(),[f,C]=(0,r.useState)({invoiceId:e?.invoiceId||t||"",amount:e?.amount||0,method:e?.method||"bank_transfer",reference:e?.reference||"",receivedDate:e?.receivedDate?new Date(e.receivedDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],notes:e?.notes||""}),[P,I]=(0,r.useState)({}),[M,Z]=(0,r.useState)(f.invoiceId?h(f.invoiceId):void 0),A=(e,t)=>{C(a=>({...a,[e]:t})),P[e]&&I(t=>({...t,[e]:""}))},S=()=>{let t={};if(f.invoiceId||(t.invoiceId="Invoice selection is required"),f.amount<=0&&(t.amount="Amount must be greater than 0"),f.method||(t.method="Payment method is required"),f.receivedDate||(t.receivedDate="Received date is required"),M&&f.amount>0){let a=y(M.id),s=("edit"===o&&e?a.filter(t=>t.id!==e.id):a).reduce((e,t)=>e+t.amount,0),r=M.totalAmount-s;f.amount>r&&(t.amount=`Amount cannot exceed remaining balance of ${E(r)}`)}if("cheque"!==f.method&&"bank_transfer"!==f.method||f.reference.trim()||(t.reference=`Reference number is required for ${k.find(e=>e.value===f.method)?.label}`),f.receivedDate&&M){let e=new Date(f.receivedDate);e<new Date(M.issueDate)&&(t.receivedDate="Payment date cannot be before invoice date");let a=new Date;a.setHours(23,59,59,999),e>a&&(t.receivedDate="Payment date cannot be in the future")}return I(t),0===Object.keys(t).length},q=async e=>{if(e.preventDefault(),!S())return;let t={invoiceId:f.invoiceId,amount:f.amount,method:f.method,reference:f.reference.trim()||void 0,receivedDate:new Date(f.receivedDate),notes:f.notes.trim()||void 0};await i(t)},E=e=>new Intl.NumberFormat("en-SG",{style:"currency",currency:"SGD"}).format(e),T=(()=>{if(!M)return null;let t=y(M.id),a=("edit"===o&&e?t.filter(t=>t.id!==e.id):t).reduce((e,t)=>e+t.amount,0),s=M.totalAmount-a,r=s-f.amount;return{invoiceTotal:M.totalAmount,totalPaid:a,remainingAmount:s,newBalance:Math.max(r,0),isFullyPaid:r<=0}})(),_="add"===o?u.filter(e=>"paid"!==e.status&&"cancelled"!==e.status&&y(e.id).reduce((e,t)=>e+t.amount,0)<e.totalAmount):u;return a?s.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,s.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[s.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:s.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75",onClick:n})}),(0,s.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-3xl sm:w-full",children:[s.jsx("div",{className:"bg-white px-6 py-4 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:s.jsx(N.Z,{className:"h-5 w-5 text-green-600"})}),(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"add"===o?"Record New Payment":"Edit Payment"}),s.jsx("p",{className:"text-sm text-gray-600",children:"add"===o?"Record a payment received against an invoice":"Update payment details"})]})]}),s.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 p-2 rounded-lg hover:bg-gray-100",children:s.jsx(p.Z,{className:"h-5 w-5"})})]})}),(0,s.jsxs)("form",{onSubmit:q,className:"p-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"text-md font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(w,{className:"h-4 w-4 mr-2 text-ampere-600"}),"Invoice Information"]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice *"}),(0,s.jsxs)("select",{value:f.invoiceId,onChange:e=>A("invoiceId",e.target.value),className:(0,x.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",P.invoiceId?"border-red-300":"border-gray-300"),disabled:"edit"===o,children:[s.jsx("option",{value:"",children:"Select Invoice"}),_.map(e=>{let t=j.find(t=>t.id===e.clientId),a=y(e.id).reduce((e,t)=>e+t.amount,0),r=e.totalAmount-a;return(0,s.jsxs)("option",{value:e.id,children:[e.invoiceNumber," - ",t?.name," - ",E(r)," remaining"]},e.id)})]}),P.invoiceId&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:P.invoiceId})]}),M&&s.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Client:"}),s.jsx("p",{className:"font-medium",children:(e=>{let t=j.find(t=>t.id===e);return t?.name||"Unknown Client"})(M.clientId)})]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Invoice Date:"}),s.jsx("p",{className:"font-medium",children:new Date(M.issueDate).toLocaleDateString()})]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Due Date:"}),s.jsx("p",{className:"font-medium",children:new Date(M.dueDate).toLocaleDateString()})]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Status:"}),s.jsx("span",{className:(0,x.cn)("px-2 py-1 text-xs font-medium rounded-full ml-2","paid"===M.status?"bg-green-100 text-green-800":"overdue"===M.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:M.status.charAt(0).toUpperCase()+M.status.slice(1)})]})]})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"text-md font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(g.Z,{className:"h-4 w-4 mr-2 text-ampere-600"}),"Payment Details"]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (SGD) *"}),s.jsx("input",{type:"number",value:f.amount,onChange:e=>A("amount",parseFloat(e.target.value)||0),className:(0,x.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",P.amount?"border-red-300":"border-gray-300"),min:"0",step:"0.01"}),P.amount&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:P.amount})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),s.jsx("select",{value:f.method,onChange:e=>A("method",e.target.value),className:(0,x.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",P.method?"border-red-300":"border-gray-300"),children:k.map(e=>(0,s.jsxs)("option",{value:e.value,children:[e.icon," ",e.label]},e.value))}),P.method&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:P.method})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Reference Number",("cheque"===f.method||"bank_transfer"===f.method)&&" *"]}),s.jsx("input",{type:"text",value:f.reference,onChange:e=>A("reference",e.target.value),className:(0,x.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",P.reference?"border-red-300":"border-gray-300"),placeholder:"cheque"===f.method?"Cheque number":"bank_transfer"===f.method?"Transaction reference":"paynow"===f.method?"PayNow reference":"Payment reference"}),P.reference&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:P.reference})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Received Date *"}),s.jsx("input",{type:"date",value:f.receivedDate,onChange:e=>A("receivedDate",e.target.value),className:(0,x.cn)("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",P.receivedDate?"border-red-300":"border-gray-300")}),P.receivedDate&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:P.receivedDate})]})]}),(0,s.jsxs)("div",{className:"mt-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),s.jsx("textarea",{value:f.notes,onChange:e=>A("notes",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ampere-500 focus:border-ampere-500",rows:3,placeholder:"Additional notes about the payment..."})]})]}),T&&(0,s.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4",children:[(0,s.jsxs)("h4",{className:"text-md font-semibold text-gray-900 mb-3 flex items-center",children:[s.jsx(g.Z,{className:"h-4 w-4 mr-2 text-blue-600"}),"Payment Summary"]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Invoice Total:"}),s.jsx("p",{className:"font-medium text-lg",children:E(T.invoiceTotal)})]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Previously Paid:"}),s.jsx("p",{className:"font-medium text-lg",children:E(T.totalPaid)})]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Current Payment:"}),s.jsx("p",{className:"font-medium text-lg text-green-600",children:E(f.amount)})]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Remaining Balance:"}),s.jsx("p",{className:(0,x.cn)("font-bold text-xl",0===T.newBalance?"text-green-600":"text-orange-600"),children:E(T.newBalance)})]})]}),T.isFullyPaid&&(0,s.jsxs)("div",{className:"mt-3 p-3 bg-green-100 border border-green-200 rounded-lg flex items-center space-x-2",children:[s.jsx(D.Z,{className:"h-4 w-4 text-green-600"}),s.jsx("span",{className:"text-green-800 text-sm font-medium",children:"This payment will fully settle the invoice"})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-end space-x-3 pt-6 mt-6 border-t border-gray-200",children:[s.jsx("button",{type:"button",onClick:n,disabled:m,className:"btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:m,className:"btn-primary flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:m?(0,s.jsxs)(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:"add"===o?"Recording...":"Saving..."})]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx(v.Z,{className:"h-4 w-4"}),s.jsx("span",{children:"add"===o?"Record Payment":"Save Changes"})]})})]})]})]})]})}):null}var P=a(949),I=a(6333),M=a(1540),Z=a(9508),A=a(361),S=a(8998),q=a(8787),E=a(4061),T=a(2887),_=a(5932),R=a(3855);function F(){let e=(0,n.useParams)();(0,n.useRouter)();let{user:t}=(0,l.a)(),{getInvoice:a,updateInvoice:u,deleteInvoice:g,getInvoicePayments:j,addPayment:v,updatePayment:b,deletePayment:D}=(0,d.p)(),{clients:k}=(0,c.a)(),{projects:F}=(0,o.Z)(),G=e.id,O=a(G),B=j(G),[V,z]=(0,r.useState)("overview"),[L,U]=(0,r.useState)(!1),[H,W]=(0,r.useState)(!1),[Q,$]=(0,r.useState)(),[X,J]=(0,r.useState)(!1),[K,Y]=(0,r.useState)("");if(!O)return s.jsx(m.Z,{user:t||{id:"",name:"Guest",role:"finance",email:"",isActive:!0,createdAt:new Date,assignedProjects:[],permissions:{projects:{canViewAllProjects:!1,canEditAssignedProjects:!1,canCreateProjects:!1,canDeleteProjects:!1,canManageTeam:!1},finance:{canViewFinance:!0,canEditInvoices:!0,canDeleteInvoices:!1,canViewReports:!0,canManagePayments:!0},clients:{canViewClients:!0,canEditClients:!1,canCreateClients:!1,canDeleteClients:!1},system:{canManageUsers:!1,canViewAuditLogs:!1,canManageSettings:!1,canViewReports:!0}}},children:s.jsx("div",{className:"flex items-center justify-center h-96",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx(P.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Invoice Not Found"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"The invoice you're looking for doesn't exist."}),s.jsx(i.default,{href:"/finance",className:"btn-primary",children:"Back to Finance"})]})})});let ee=k.find(e=>e.id===O.clientId),et=F.find(e=>e.id===O.projectId),ea=(0,r.useMemo)(()=>{let e=B.reduce((e,t)=>e+t.amount,0),t=O.totalAmount-e;return{totalPaid:e,remainingAmount:Math.max(t,0),isFullyPaid:t<=0,paymentCount:B.length}},[O.totalAmount,B]),es=e=>new Intl.NumberFormat("en-SG",{style:"currency",currency:"SGD"}).format(e),er=async e=>{J(!0);try{await new Promise(e=>setTimeout(e,1e3)),u(O.id,e),Y("Invoice updated successfully!"),U(!1),setTimeout(()=>Y(""),3e3)}catch(e){console.error("Error updating invoice:",e)}finally{J(!1)}},en=async e=>{J(!0);try{await new Promise(e=>setTimeout(e,1e3)),v({...e,invoiceId:O.id}),W(!1),Y("Payment recorded successfully!"),setTimeout(()=>Y(""),3e3)}catch(e){console.error("Error recording payment:",e)}finally{J(!1)}},ei=async e=>{if(Q){J(!0);try{await new Promise(e=>setTimeout(e,1e3)),b(Q.id,e),$(void 0),Y("Payment updated successfully!"),setTimeout(()=>Y(""),3e3)}catch(e){console.error("Error updating payment:",e)}finally{J(!1)}}},el=t?.role==="super_admin"||t?.role==="admin"||t?.role==="finance";return t?(0,s.jsxs)(m.Z,{user:t||{id:"",name:"Guest",role:"finance",email:"",isActive:!0,createdAt:new Date,assignedProjects:[],permissions:{projects:{canViewAllProjects:!1,canEditAssignedProjects:!1,canCreateProjects:!1,canDeleteProjects:!1,canManageTeam:!1},finance:{canViewFinance:!0,canEditInvoices:!0,canDeleteInvoices:!1,canViewReports:!0,canManagePayments:!0},clients:{canViewClients:!0,canEditClients:!1,canCreateClients:!1,canDeleteClients:!1},system:{canManageUsers:!1,canViewAuditLogs:!1,canManageSettings:!1,canViewReports:!0}}},children:[(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[s.jsx(i.default,{href:"/finance",className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:s.jsx(I.Z,{className:"h-5 w-5"})}),(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:O.invoiceNumber}),(0,s.jsxs)("p",{className:"text-gray-600",children:[ee?.name," • ",es(O.totalAmount)]})]})]}),el&&(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsxs)("button",{className:"btn-secondary flex items-center space-x-2",children:[s.jsx(M.Z,{className:"h-4 w-4"}),s.jsx("span",{children:"Download PDF"})]}),(0,s.jsxs)("button",{onClick:()=>U(!0),className:"btn-secondary flex items-center space-x-2",children:[s.jsx(Z.Z,{className:"h-4 w-4"}),s.jsx("span",{children:"Edit Invoice"})]})]})]}),K&&(0,s.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[s.jsx(A.Z,{className:"h-5 w-5 text-green-600"}),s.jsx("span",{className:"text-green-800 font-medium",children:K})]}),s.jsx("button",{onClick:()=>Y(""),className:"text-green-600 hover:text-green-800",children:s.jsx(p.Z,{className:"h-4 w-4"})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsx("div",{className:"metric-card",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Invoice Total"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:es(O.totalAmount)})]}),s.jsx(w,{className:"h-8 w-8 text-gray-600"})]})}),s.jsx("div",{className:"metric-card",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Amount Paid"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:es(ea.totalPaid)})]}),s.jsx(A.Z,{className:"h-8 w-8 text-green-600"})]})}),s.jsx("div",{className:"metric-card",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Outstanding"}),s.jsx("p",{className:(0,x.cn)("text-2xl font-bold",ea.remainingAmount>0?"text-orange-600":"text-green-600"),children:es(ea.remainingAmount)})]}),ea.remainingAmount>0?s.jsx(S.Z,{className:"h-8 w-8 text-orange-600"}):s.jsx(A.Z,{className:"h-8 w-8 text-green-600"})]})})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200",children:[s.jsx("div",{className:"border-b border-gray-200",children:(0,s.jsxs)("nav",{className:"flex space-x-8 px-6",children:[(0,s.jsxs)("button",{onClick:()=>z("overview"),className:(0,x.cn)("flex items-center space-x-2 py-4 border-b-2 font-medium text-sm","overview"===V?"border-ampere-500 text-ampere-600":"border-transparent text-gray-500"),children:[s.jsx(h.Z,{className:"h-4 w-4"}),s.jsx("span",{children:"Overview"})]}),(0,s.jsxs)("button",{onClick:()=>z("payments"),className:(0,x.cn)("flex items-center space-x-2 py-4 border-b-2 font-medium text-sm","payments"===V?"border-ampere-500 text-ampere-600":"border-transparent text-gray-500"),children:[s.jsx(N.Z,{className:"h-4 w-4"}),(0,s.jsxs)("span",{children:["Payments (",B.length,")"]})]})]})}),(0,s.jsxs)("div",{className:"p-6",children:["overview"===V&&(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Invoice Details"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[s.jsx(y.Z,{className:"h-4 w-4 text-gray-400"}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Issue Date"}),s.jsx("p",{className:"font-medium",children:new Date(O.issueDate).toLocaleDateString()})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[s.jsx(S.Z,{className:"h-4 w-4 text-gray-400"}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Due Date"}),s.jsx("p",{className:"font-medium",children:new Date(O.dueDate).toLocaleDateString()})]})]}),et&&(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[s.jsx(q.Z,{className:"h-4 w-4 text-gray-400"}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Project"}),s.jsx("p",{className:"font-medium",children:et.name})]})]})]})]}),ee&&(0,s.jsxs)("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Client Information"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[s.jsx(E.Z,{className:"h-4 w-4 text-gray-400"}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Client Name"}),s.jsx("p",{className:"font-medium",children:ee.name})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[s.jsx(T.Z,{className:"h-4 w-4 text-gray-400"}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Phone"}),s.jsx("p",{className:"font-medium",children:ee.phone})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[s.jsx(_.Z,{className:"h-4 w-4 text-gray-400"}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Email"}),s.jsx("p",{className:"font-medium",children:ee.email})]})]})]})]})]}),"payments"===V&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Payment History"}),el&&!ea.isFullyPaid&&(0,s.jsxs)("button",{onClick:()=>W(!0),className:"btn-primary flex items-center space-x-2",children:[s.jsx(R.Z,{className:"h-4 w-4"}),s.jsx("span",{children:"Record Payment"})]})]}),B.length>0?s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Method"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),s.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:B.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("p",{className:"font-medium text-green-600",children:es(e.amount)})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("p",{className:"text-gray-900 capitalize",children:e.method.replace("_"," ")})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("p",{className:"text-gray-900",children:new Date(e.receivedDate).toLocaleDateString()})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:s.jsx("div",{className:"flex items-center justify-end space-x-2",children:el&&s.jsx("button",{onClick:()=>$(e),className:"text-gray-600 hover:text-gray-900",children:s.jsx(Z.Z,{className:"h-4 w-4"})})})})]},e.id))})]})}):(0,s.jsxs)("div",{className:"text-center py-12",children:[s.jsx(N.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Payments Recorded"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"No payments have been recorded for this invoice yet."}),el&&s.jsx("button",{onClick:()=>W(!0),className:"btn-primary",children:"Record First Payment"})]})]})]})]})]}),s.jsx(f,{invoice:O,isOpen:L,onClose:()=>U(!1),onSave:er,mode:"edit",isLoading:X}),s.jsx(C,{invoiceId:O.id,isOpen:H,onClose:()=>W(!1),onSave:en,mode:"add",isLoading:X}),s.jsx(C,{payment:Q,isOpen:!!Q,onClose:()=>$(void 0),onSave:ei,mode:"edit",isLoading:X})]}):null}},1886:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(8570).createProxy)(String.raw`C:\Users\stamm\AMPERE WEBAPP\src\app\finance\[id]\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[935,910,370,884],()=>a(7570));module.exports=s})();